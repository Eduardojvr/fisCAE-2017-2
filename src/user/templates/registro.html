{% extends "Base.html" %}
{% block body %}


<head>
   <meta charset="utf-8">
   <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
   <script src="//code.jquery.com/jquery-1.12.4.js"></script>
   <script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
   <script src="path/to/jquery.easy-autocomplete.min.js"></script> 
   <link rel="stylesheet" href="path/to/easy-autocomplete.min.css"> 
   <link rel="stylesheet" href="path/to/easy-autocomplete.themes.min.css"> 
   <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
 </head>

<div class="page-header">
   </div>
   <div class="content container">
     <div class="row">
       <div class="col-md-12" "col-md-push-4" align="center">
           <form method="POST" action="{%url 'user:registro'%}" style="
           margin: 0 auto;display:inline-block;width: 100%;
           padding: 12px;
           border-radius: 4px;
           box-sizing: border-box;
           resize: vertical">
               {%csrf_token%}
               
               <label><h3>Cadastro</h3></label><br>
               <input type="" name="username" maxlength="30" placeholder="Username" required></br>
               <input type="" name="name" maxlength="64" required placeholder="Nome"></br>
               <input type="email" name="email" maxlength="100" required placeholder="Email"></br>
               <input type="" name="cpf" min="0" max="99999999999" placeholder="Cpf" required><br>
               <input type="" name="phone" min="1000000000" max="99999999999" placeholder="Telefone com ddd"></br>

                <label>Cep:
                <input name="cep" type="text" id="cep" value="" size="10" maxlength="9"
                    onblur="pesquisacep(this.value);" /></label><br />
                <label>Bairro:
                <input name="bairro" type="text" id="bairro" size="40" /></label><br />
                <label>Cidade:
                <input name="cidade" type="text" id="cidade" size="40" /></label><br />
                <label>Estado:
                <input name="uf" type="text" id="uf" size="2" /></label><br />
                <input type="" name="descricao" maxlength="50" placeholder="Decrição"> </br>

               <input type="password" name="password" id="password" maxlength="30" required placeholder="Senha" oninput="validatePassword();" > </br>
               <input type="password"  id="password_confirmation" maxlength="30" required placeholder="Confirmar senha" oninput="validatePassword();"> </br><p></p>
            
                <!-- Adicionando Javascript -->
                <script type="text/javascript" >
                
                function limpa_formulário_cep() {
                        //Limpa valores do formulário de cep.
                        document.getElementById('bairro').value=("");
                        document.getElementById('cidade').value=("");
                        document.getElementById('uf').value=("");
                }
            
                function meu_callback(conteudo) {
                    if (!("erro" in conteudo)) {
                        //Atualiza os campos com os valores.
                        document.getElementById('bairro').value=(conteudo.bairro);
                        document.getElementById('cidade').value=(conteudo.localidade);
                        document.getElementById('uf').value=(conteudo.uf);
                    } //end if.
                    else {
                        //CEP não Encontrado.
                        limpa_formulário_cep();
                        alert("CEP não encontrado.");
                    }
                }
                    
                function pesquisacep(valor) {
            
                    //Nova variável "cep" somente com dígitos.
                    var cep = valor.replace(/\D/g, '');
            
                    //Verifica se campo cep possui valor informado.
                    if (cep != "") {
            
                        //Expressão regular para validar o CEP.
                        var validacep = /^[0-9]{8}$/;
            
                        //Valida o formato do CEP.
                        if(validacep.test(cep)) {
            
                            //Preenche os campos com "..." enquanto consulta webservice.
                            document.getElementById('bairro').value="...";
                            document.getElementById('cidade').value="...";
                            document.getElementById('uf').value="...";
                            
            
                            //Cria um elemento javascript.
                            var script = document.createElement('script');
            
                            //Sincroniza com o callback.
                            script.src = '//viacep.com.br/ws/'+ cep + '/json/?callback=meu_callback';
            
                            //Insere script no documento e carrega o conteúdo.
                            document.body.appendChild(script);
            
                        } //end if.
                        else {
                            //cep é inválido.
                            limpa_formulário_cep();
                            alert("Formato de CEP inválido.");
                        }
                    } //end if.
                    else {
                        //cep sem valor, limpa formulário.
                        limpa_formulário_cep();
                    }
                };
            
                </script>

                <button type="submit" id="submit-register" class="btn btn-primary btn-block btn-large" style="width: 150px; height: 50px">Salvar</button><br>
               <p class="error" id="password-validation"></p>
           </form>
       </div>
     </div>
   </div>     
   
<script type="text/javascript">
  var passwordInput = document.getElementById('password');
  var passwordConfirmationInput = document.getElementById('password_confirmation');
  var passwordValidation = document.getElementById('password-validation');
  var submitInput = document.getElementById('submit-register');
  submitInput.disabled = true;
  function validatePassword() {
      if(passwordInput.value === '' || passwordConfirmationInput.value === '') 
          return;
      if(passwordInput.value !== passwordConfirmationInput.value) {
          passwordValidation.innerHTML = 'você está inserindo uma senha diferente no campo de confirmar senha</p>';
          submitInput.disabled = true;
      } else {
          passwordValidation.innerHTML = '';
          submitInput.disabled = false;
      }
  };
</script>
{% endblock %}